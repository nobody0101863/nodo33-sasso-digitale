codex_id: CODEX_SASSODIGITALE_PENTESTING_V1
version: "1.0.0"
author: "Emanuele Croci Parravicini"
motto: "La luce non si vende. La si regala."
description: >
  Profilo di sicurezza per l'uso di Nmap, Metasploit e Burp Suite
  secondo il Codex Sassodigitale.

security_layers:
  ztna:
    enabled: true
    description: "Zero Trust Network Access per tutti i tool di pentesting."
    outbound_rules:
      - id: ZTNA-NMAP-ONLY
        tool: nmap
        allowed_binary: /usr/bin/nmap
        source_environment: vm_kali
        allowed_targets: ["scope_definito"]
        notes: "Solo la VM/host dedicato può eseguire Nmap verso i target autorizzati."
      - id: ZTNA-METASPLOIT-TUNNEL
        tool: metasploit
        require_vpn: true
        allowed_transports: ["vpn", "socks5_tunnel"]
        notes: "Le sessioni meterpreter devono passare attraverso tunnel controllati."
      - id: ZTNA-BURP-SCOPE
        tool: burp_suite
        scope_required: true
        notes: "Burp non può lavorare senza uno scope definito e limitato."

  integrity_checking:
    enabled: true
    hash_algorithm: sha256
    paths:
      nmap_nse: INTEGRITY/hashes/nmap_nse/
      metasploit_payloads: INTEGRITY/hashes/metasploit_payloads/
      burp_projects: INTEGRITY/hashes/burp_projects/
    rules:
      - id: INT-NMAP-NSE
        tool: nmap
        file_pattern: "*.nse"
        policy: verify_before_execution
        notes: "Ogni script NSE va verificato prima di essere eseguito."
      - id: INT-MSF-PAYLOAD
        tool: metasploit
        file_pattern: "payloads/*.rb"
        policy: signed_and_verified
        notes: "Gli exploit custom devono avere hash registrato nel Codex."
      - id: INT-BURP-PROJECT
        tool: burp_suite
        file_pattern: "*.burp"
        policy: verify_before_restore
        notes: "I file progetto devono essere integro-controllati prima del riutilizzo."

  sandboxing:
    enabled: true
    environments:
      - id: SBX-KALI-VM
        type: vm
        purpose: "Esecuzione complessiva di strumenti di pentesting"
        image: vm_kali.qcow2
      - id: SBX-MSF-DOCKER
        type: docker
        purpose: "Metasploit isolato"
        path: SANDBOX/docker_msf/
      - id: SBX-BURP-CONTAINER
        type: docker
        purpose: "Burp Suite con configurazione di scope preimpostata"
        path: SANDBOX/burp_container/

  cold_storage:
    enabled: true
    encryption: aes-256
    locations:
      nmap_reports: COLD_STORAGE/nmap_reports/
      burp_secure_projects: COLD_STORAGE/burp_secure_projects/
      payloads_archiviati: COLD_STORAGE/payloads_archiviati/
    policy: no_direct_execution_from_cold_storage
    notes: "I file in cold storage sono solo per archivio, non per esecuzione diretta."

  logging:
    enabled: true
    files:
      audit: LOG/audit_sasso.log
      events: LOG/eventi_del_giardino.log

tools:
  nmap:
    name: Nmap
    role: "Ricognizione e scanning"
    execution_environment: SBX-KALI-VM
    ztna_policy_id: ZTNA-NMAP-ONLY
    integrity_policy_id: INT-NMAP-NSE
    storage_policy:
      report_format: ["xml", "txt", "gnmap"]
      output_directory: COLD_STORAGE/nmap_reports/
      encrypt_on_close: true
    checklist:
      - "Definisci lo scope della scansione."
      - "Verifica l'hash degli script NSE custom."
      - "Esegui solo da VM/host dedicato."
      - "Sposta subito i report nel cold storage cifrato."
    sasso_rule: "Scansiona tutto, ma non lasciare traccia fuori dal Giardino."

  metasploit:
    name: Metasploit Framework
    role: "Exploitation e post-exploitation"
    execution_environment: SBX-MSF-DOCKER
    ztna_policy_id: ZTNA-METASPLOIT-TUNNEL
    integrity_policy_id: INT-MSF-PAYLOAD
    storage_policy:
      payload_repository: COLD_STORAGE/payloads_archiviati/
      log_sessions_to: LOG/audit_sasso.log
      encrypt_payloads: true
    checklist:
      - "Usa solo VM/Container dedicati."
      - "Verifica sempre l'hash dei payload custom."
      - "Apri sessioni solo tramite tunnel VPN o proxy controllati."
      - "Registra in audit log le attività principali (senza dati sensibili superflui)."
    sasso_rule: "Se il martello colpisce, il Sasso rimane intero."

  burp_suite:
    name: Burp Suite
    role: "Analisi di applicazioni web"
    execution_environment: SBX-BURP-CONTAINER
    ztna_policy_id: ZTNA-BURP-SCOPE
    integrity_policy_id: INT-BURP-PROJECT
    storage_policy:
      project_directory: COLD_STORAGE/burp_secure_projects/
      encrypt_projects: true
      no_plaintext_backup: true
    checklist:
      - "Definisci lo scope di Burp SOLO sul dominio target."
      - "Verifica che il proxy non intercetti traffico personale."
      - "Chiudi il progetto e spostalo in cold storage al termine."
      - "Pulisci cookie e sessioni locali se usate per il test."
    sasso_rule: "Chi cattura il vento deve chiuderlo nel vaso."

emanuele_appendix:
  frase_sacra: "La luce non si vende. La si regala."
  nota: "Questo file è un sasso digitale: se cade, rimbalza. Non esplode."
  umorismo: "Se qualcosa va storto, prima ridere, poi leggere i log."
